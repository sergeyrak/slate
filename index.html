
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Gifty Console API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#request" class="toc-h2 toc-link" data-title="Introduction">Request</a>
                  </li>
                  <li>
                    <a href="#response" class="toc-h2 toc-link" data-title="Introduction">Response</a>
                  </li>
                  <li>
                    <a href="#endpoints" class="toc-h2 toc-link" data-title="Introduction">Endpoints</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#firebase-api-endpoints" class="toc-h1 toc-link" data-title="Firebase API Endpoints">Firebase API Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-console" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Console</a>
                  </li>
                  <li>
                    <a href="#create-console-api-key" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Console API Key</a>
                  </li>
                  <li>
                    <a href="#delete-console-api-key" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Delete Console API Key</a>
                  </li>
                  <li>
                    <a href="#create-campaign" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Campaign</a>
                  </li>
                  <li>
                    <a href="#create-campaign-auth-code" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Campaign Auth Code</a>
                  </li>
                  <li>
                    <a href="#delete-campaign-auth-code" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Delete Campaign Auth Code</a>
                  </li>
                  <li>
                    <a href="#add-campaign-user" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Add Campaign User</a>
                  </li>
                  <li>
                    <a href="#delete-campaign-user" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Delete Campaign User</a>
                  </li>
                  <li>
                    <a href="#set-campaign-offer" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Set Campaign Offer</a>
                  </li>
                  <li>
                    <a href="#create-agreement" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Agreement</a>
                  </li>
                  <li>
                    <a href="#create-agreement-auth-code" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Agreement Auth Code</a>
                  </li>
                  <li>
                    <a href="#delete-agreement-auth-code" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Delete Agreement Auth Code</a>
                  </li>
                  <li>
                    <a href="#assign-agreement" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Assign Agreement</a>
                  </li>
                  <li>
                    <a href="#create-link" class="toc-h2 toc-link" data-title="Firebase API Endpoints">Create Link</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#rest-api-endpoints" class="toc-h1 toc-link" data-title="REST API Endpoints">REST API Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#verify-key" class="toc-h2 toc-link" data-title="REST API Endpoints">Verify Key</a>
                  </li>
                  <li>
                    <a href="#get-available-offers" class="toc-h2 toc-link" data-title="REST API Endpoints">Get Available Offers</a>
                  </li>
                  <li>
                    <a href="#link-creation" class="toc-h2 toc-link" data-title="REST API Endpoints">Link Creation</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>API is based on request-response pattern, in which:</p>

<ul>
<li>client sends request to server and is waiting for response.</li>
<li>server receives request and sends response when request was processed.</li>
<li>client receives a response.</li>
</ul>
<h2 id='request'>Request</h2>
<blockquote>
<p>Example of create a new campaign request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_campaign'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Hlk20dJKsd7'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Campaign'</span><span class="p">,</span>
        <span class="nx">type</span><span class="p">:</span> <span class="s1">'email'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Server accepts requests with next required parameters:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>request type</td>
</tr>
<tr>
<td>console_id</td>
<td>originator console ID</td>
</tr>
<tr>
<td>bundle</td>
<td>request related parameters</td>
</tr>
<tr>
<td>wait_for_response_at</td>
<td>path related to responses endpoint where server must push the response</td>
</tr>
</tbody></table>
<h2 id='response'>Response</h2>
<blockquote>
<p>Example of response on create a new campaign request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-Lkjadf8134'</span><span class="p">,</span>
    <span class="nx">campaign_id</span><span class="p">:</span> <span class="s1">'-B89daKsdf8'</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Full response&#39;s path in this case looks like <b>/api/v1/responses/-Hlk20dJKsd7</b></p>
</blockquote>

<p>Server responses have the next common parameters:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>request_id</td>
<td>original request ID</td>
</tr>
<tr>
<td>error</td>
<td>means the request processing has failed and contains error description</td>
</tr>
</tbody></table>

<aside class="notice">
Response's path is built like: <b>responses path</b>/<b>console_id</b>/<b>request's wait_for_response_at</b>, exception is the console and link creation requests.
</aside>
<h2 id='endpoints'>Endpoints</h2>
<table><thead>
<tr>
<th>Path</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/api/v1/requests</code></td>
<td>incomming requests endpoint</td>
</tr>
<tr>
<td><code>/api/v1/responses</code></td>
<td>outgoing responses endpoint</td>
</tr>
</tbody></table>
<h1 id='firebase-api-endpoints'>Firebase API Endpoints</h1><h2 id='create-console'>Create Console</h2>
<blockquote>
<p>Example of console creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_console'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Console'</span><span class="p">,</span>
        <span class="nx">vendor</span><span class="p">:</span> <span class="s1">'rosso'</span><span class="p">,</span>
        <span class="nx">uid</span><span class="p">:</span> <span class="s1">'ajj234k091234ajlqrlerhj'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Creates a new console and links it with registered user if user ID is provided.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_console&#39;</code></td>
</tr>
<tr>
<td>bundle.name</td>
<td>YES</td>
<td>console name</td>
</tr>
<tr>
<td>bundle.uid</td>
<td>YES</td>
<td>user ID which must be linked with new console</td>
</tr>
<tr>
<td>bundle.vendor</td>
<td>NO</td>
<td>vendor name</td>
</tr>
</tbody></table>

<aside class="notice">
Please notice that this request doesn't require a <b>console_id</b> attribute. That's why response is pushed directly to <b>responses path</b>/<b>request's wait_for_response_at</b>.
</aside>

<blockquote>
<p>Example of console creation response:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-LJKd08jkad'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>console_id</td>
<td>created console ID</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed console creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Bjasf8234l'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Console'</span><span class="p">,</span>
        <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
        <span class="nx">console_creation_date</span><span class="p">:</span> <span class="mi">1505480785652</span><span class="p">,</span>
        <span class="nx">vendor</span><span class="p">:</span> <span class="s1">'rosso'</span><span class="p">,</span>
        <span class="nx">payment</span><span class="p">:</span> <span class="p">{</span>
            <span class="nl">balance</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">cad</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nl">cents</span><span class="p">:</span> <span class="mi">0</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">users</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'ajj234k091234ajlqrlerhj'</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span>
<span class="p">},</span>
<span class="nx">consoles_by_vendor</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'rosso'</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/consoles</code></td>
<td>adds a new console instance</td>
</tr>
<tr>
<td><code>/users</code></td>
<td>creates mapping for console by user ID</td>
</tr>
<tr>
<td><code>/consoles_by_vendor</code></td>
<td>creates mapping for console by vendor name if it was provided</td>
</tr>
</tbody></table>
<h2 id='create-console-api-key'>Create Console API Key</h2>
<blockquote>
<p>Example of console&#39;s API key creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_console_apikey'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span>
<span class="p">}</span>
</code></pre>
<p>Creates a new API key for existing console to get access to REST API.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_console_api_key&#39;</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response for creation console&#39;s API key:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-HG72Kjaye'</span><span class="p">,</span>
    <span class="nx">api_key</span><span class="p">:</span> <span class="s1">'231d5833-4734-4652-9d8c-64295437f4e5'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>api_key</td>
<td>created API key</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed console&#39;s API key creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Bjasf8234l'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">api_keys</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'231d5833-4734-4652-9d8c-64295437f4e5'</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">consoles_api_keys</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'231d5833-4734-4652-9d8c-64295437f4e5'</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/consoles/[console_id]/api_keys</code></td>
<td>adds a new key to console instance</td>
</tr>
<tr>
<td><code>/consoles_api_keys</code></td>
<td>adds mapping to console ID by API key</td>
</tr>
</tbody></table>
<h2 id='delete-console-api-key'>Delete Console API Key</h2>
<blockquote>
<p>Example of request for deleting console&#39;s API key:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'delete_console_api_key'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">api_key</span><span class="p">:</span> <span class="s1">'231d5833-4734-4652-9d8c-64295437f4e5'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Deletes an existing console&#39;s API key and drops access to REST API using this key.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;delete_console_api_key&#39;</code></td>
</tr>
<tr>
<td>bundle.api_key</td>
<td>YES</td>
<td>API key</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response after deleting console&#39;s API key:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-L72HL9asdK'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/consoles/[console_id]/api_keys</code></td>
<td>deletes key from console API keys</td>
</tr>
<tr>
<td><code>/consoles_api_keys</code></td>
<td>removes mapping to console ID by API key</td>
</tr>
</tbody></table>
<h2 id='create-campaign'>Create Campaign</h2>
<blockquote>
<p>Example of campaign creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_campaign'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Campaign'</span><span class="p">,</span>
        <span class="nx">type</span><span class="p">:</span> <span class="s1">'email'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Creates a new active campaign for console. </p>

<p>Each console has a virtual <em>public campaign</em> to group the users which don’t belong to any of console’s campaigns. Public campaign has ID in the next format: <code>[console_id]_public</code>.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_campaign&#39;</code></td>
</tr>
<tr>
<td>bundle.name</td>
<td>YES</td>
<td>campaign name</td>
</tr>
<tr>
<td>bundle.type</td>
<td>YES</td>
<td>campaign type: <code>&#39;email&#39;</code> or <code>&#39;phone&#39;</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of campaign creation response:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-HU48fja9Hd'</span><span class="p">,</span>
    <span class="nx">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>campaign_id</td>
<td>created campaign ID</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed campaign creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">campaigns</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Kha84laiFaj'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Campaign'</span><span class="p">,</span>
        <span class="nx">type</span><span class="p">:</span> <span class="s1">'email'</span><span class="p">,</span>
        <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Bjasf8234l'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaigns</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'-Kha84laiFaj'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/campaigns</code></td>
<td>adds a new campaign instance</td>
</tr>
<tr>
<td><code>/consoles/[console_id]/campaigns</code></td>
<td>adds reference for created campaign</td>
</tr>
</tbody></table>
<h2 id='create-campaign-auth-code'>Create Campaign Auth Code</h2>
<blockquote>
<p>Example of campaign&#39;s auth code creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_campaign_auth_code'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Creates a new auth code for existing console&#39;s campaign.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_campaign_auth_code&#39;</code></td>
</tr>
<tr>
<td>bundle.campaign_id</td>
<td>YES</td>
<td>campaign ID</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response for creation campaign&#39;s auth code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-HU48fja9Hd'</span><span class="p">,</span>
    <span class="nx">auth_code</span><span class="p">:</span> <span class="s1">'5ae5bf46-2a47-477d-973e-a5dacda42f1c'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>auth_code</td>
<td>created auth code</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed campaign&#39;s auth code creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">campaigns</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Kha84laiFaj'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">auth_codes</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'5ae5bf46-2a47-477d-973e-a5dacda42f1c'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/campaigns/[campaign_id]/auth_codes</code></td>
<td>adds a new auth code to campaign instance</td>
</tr>
</tbody></table>
<h2 id='delete-campaign-auth-code'>Delete Campaign Auth Code</h2>
<blockquote>
<p>Example of request for deleting campaign&#39;s auth code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'delete_campaign_auth_code'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span><span class="p">,</span>
        <span class="nx">auth_code</span><span class="p">:</span> <span class="s1">'5ae5bf46-2a47-477d-973e-a5dacda42f1c'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Deletes an existing campaign&#39;s auth code. If auth code is associated with user, it will be removed from campaign as well.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;delete_campaign_auth_code&#39;</code></td>
</tr>
<tr>
<td>bundle.campaign_id</td>
<td>YES</td>
<td>campaign ID</td>
</tr>
<tr>
<td>bundle.auth_code</td>
<td>YES</td>
<td>auth code</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response after deleting campaigns&#39;s auth code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-N8padslq03'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/campaigns/[campaign_id]/auth_codes</code></td>
<td>deletes auth code from campaign instance</td>
</tr>
</tbody></table>
<h2 id='add-campaign-user'>Add Campaign User</h2>
<blockquote>
<p>Example of request for adding user (phone) to campaign:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'add_campaign_user'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span><span class="p">,</span>
        <span class="nx">auth_code</span><span class="p">:</span> <span class="s1">'beb0eee9-9ece-4422-a423-bb8f3bc5ba7c'</span><span class="p">,</span>
        <span class="nx">user_id</span><span class="p">:</span> <span class="s1">'+111222333444'</span><span class="p">,</span>
        <span class="nx">user_type</span><span class="p">:</span> <span class="s1">'phone'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Adds a new user to console&#39;s campaign. User can be email address or phone number.
Phone numbers require a free auth code to be provided.
If user is already assigned to another campaign, his access to that campaign is revoked and he will be accosiated with new one.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;add_campaign_user&#39;</code></td>
</tr>
<tr>
<td>bundle.campaign_id</td>
<td>YES</td>
<td>campaign ID</td>
</tr>
<tr>
<td>bundle.auth_code</td>
<td>YES</td>
<td>auth code which is required only for <code>&#39;phone&#39;</code> user</td>
</tr>
<tr>
<td>bundle.user_id</td>
<td>YES</td>
<td>phone number or email address</td>
</tr>
<tr>
<td>bundle.user_type</td>
<td>YES</td>
<td>user&#39;s type: <code>&#39;email&#39;</code> or <code>&#39;phone&#39;</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of successfull response after adding a phone to campaign:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-Ykjha7834ja'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">campaigns</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Kha84laiFaj'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">auth_codes</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'beb0eee9-9ece-4422-a423-bb8f3bc5ba7c'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nx">user</span><span class="p">:</span> <span class="s1">'+111222333444'</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">phones</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'+111222333444'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">code</span><span class="p">:</span> <span class="s1">'beb0eee9-9ece-4422-a423-bb8f3bc5ba7c'</span><span class="p">,</span>
                <span class="nx">active</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">consoles_users</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'+111222333444'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">type</span><span class="p">:</span> <span class="s1">'phone'</span><span class="p">,</span>
        <span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'-Bjasf8234l'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">campaigns</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'-Kha84laiFaj'</span><span class="p">:</span> <span class="s1">'beb0eee9-9ece-4422-a423-bb8f3bc5ba7c'</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/campaigns/[campaign_id]/[user_type]</code></td>
<td>creates a reference to user</td>
</tr>
<tr>
<td><code>/campaigns/auth_codes/[code]</code></td>
<td>adds a reference to user for used auth code</td>
</tr>
<tr>
<td><code>/consoles_users/[user_id]</code></td>
<td>adds a new user information</td>
</tr>
</tbody></table>
<h2 id='delete-campaign-user'>Delete Campaign User</h2>
<blockquote>
<p>Example of request for deleting user from campaign:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'delete_campaign_user'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span><span class="p">,</span>
        <span class="nx">user_id</span><span class="p">:</span> <span class="s1">'+111222333444'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Deletes an existing user from console&#39;s campaign.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;delete_campaign_user&#39;</code></td>
</tr>
<tr>
<td>bundle.campaign_id</td>
<td>YES</td>
<td>campaign ID</td>
</tr>
<tr>
<td>bundle.user_id</td>
<td>YES</td>
<td>phone number or email address</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of successfull response after deleting a user from campaign:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-KW7k2bm292as'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/campaigns/[campaign_id]/[user_type]</code></td>
<td>deletes a user reference from campaign</td>
</tr>
<tr>
<td><code>/campaigns/auth_codes/[code]</code></td>
<td>frees associated auth code in case of phone number</td>
</tr>
<tr>
<td><code>/consoles_users/[user_id]</code></td>
<td>deletes user instance</td>
</tr>
</tbody></table>
<h2 id='set-campaign-offer'>Set Campaign Offer</h2>
<blockquote>
<p>Example of request to set a default campaign&#39;s offer:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'set_campaign_offer'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span><span class="p">,</span>
        <span class="nx">offer</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Sets a default campaign&#39;s offer.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;set_campaign_offer&#39;</code></td>
</tr>
<tr>
<td>bundle.campaign_id</td>
<td>YES</td>
<td>campaign ID</td>
</tr>
<tr>
<td>bundle.offer</td>
<td>YES</td>
<td>offer ID</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response after campaign&#39;s offer has been set:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-Y7Jla4a90U'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">campaigns</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Kha84laiFaj'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">offer</span><span class="p">:</span> <span class="p">{</span>
            <span class="nl">id</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span><span class="p">,</span>
            <span class="nx">vendor</span><span class="p">:</span> <span class="s1">'ollia'</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/campaigns/[campaign_id]/offer</code></td>
<td>sets campaign&#39;s default offer details</td>
</tr>
</tbody></table>
<h2 id='create-agreement'>Create Agreement</h2>
<blockquote>
<p>Example of agreement creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_agreement'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Agreement'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Creates a new active agreement for console. </p>

<p>Each console has a virtual <em>public agreement</em> to for users which don’t belong to any other console’s agreements. Public agreement has ID in  format: <code>[console_id]_public</code>.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_agreement&#39;</code></td>
</tr>
<tr>
<td>bundle.name</td>
<td>YES</td>
<td>agreement name</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of agreeement creation response:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-HU48fja9Hd'</span><span class="p">,</span>
    <span class="nx">agreement_id</span><span class="p">:</span> <span class="s1">'-KuYrIw65D3'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>agreement_id</td>
<td>created agreement ID</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed agreement creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">agreements</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-KuYrIw65D3'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">name</span><span class="p">:</span> <span class="s1">'My Agreement'</span><span class="p">,</span>
        <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Bjasf8234l'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">agreements</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'-KuYrIw65D3'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nx">owner</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/agreements</code></td>
<td>adds a new agreement instance</td>
</tr>
<tr>
<td><code>/consoles/[console_id]/agreements</code></td>
<td>adds reference for created agreement</td>
</tr>
</tbody></table>
<h2 id='create-agreement-auth-code'>Create Agreement Auth Code</h2>
<blockquote>
<p>Example of agreement&#39;s auth code creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_agreement_auth_code'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">agreement_id</span><span class="p">:</span> <span class="s1">'-KuYrIw65D3'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Creates a new auth code for existing console&#39;s agreement.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_agreement_auth_code&#39;</code></td>
</tr>
<tr>
<td>bundle.agreement_id</td>
<td>YES</td>
<td>agreement ID</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response for creation agreement&#39;s auth code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-Jhr7u32lk'</span><span class="p">,</span>
    <span class="nx">auth_code</span><span class="p">:</span> <span class="s1">'73376d6a-e457-4a66-b06a-c16a637cfa4b'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>auth_code</td>
<td>created auth code</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed agreement&#39;s auth code creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">agreements</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-KuYrIw65D3'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">auth_codes</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'73376d6a-e457-4a66-b06a-c16a637cfa4b'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/agreements/[agreement_id]/auth_codes</code></td>
<td>adds a new auth code to agreement instance</td>
</tr>
</tbody></table>
<h2 id='delete-agreement-auth-code'>Delete Agreement Auth Code</h2>
<blockquote>
<p>Example of request for deleting agreement&#39;s auth code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'delete_agreement_auth_code'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">agreement_id</span><span class="p">:</span> <span class="s1">'-KuYrIw65D3'</span><span class="p">,</span>
        <span class="nx">auth_code</span><span class="p">:</span> <span class="s1">'73376d6a-e457-4a66-b06a-c16a637cfa4b'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Deletes an existing agreement&#39;s auth code. If auth code is already assigned to another console, assignment will be dropped as well.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;delete_agreement_auth_code&#39;</code></td>
</tr>
<tr>
<td>bundle.agreement_id</td>
<td>YES</td>
<td>agreement ID</td>
</tr>
<tr>
<td>bundle.auth_code</td>
<td>YES</td>
<td>auth code</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response after deleting agreement&#39;s auth code:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-Kl81faklza'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/agreements/[agreement_id]/auth_codes</code></td>
<td>deletes auth code from agreement instance</td>
</tr>
<tr>
<td><code>/agreements/[agreement_id]/auth_clients</code></td>
<td>deletes auth client assigned to auth code</td>
</tr>
<tr>
<td><code>/consoles/[cliend_id]/agreements</code></td>
<td>deletes reference to assigned agreement</td>
</tr>
</tbody></table>
<h2 id='assign-agreement'>Assign Agreement</h2>
<blockquote>
<p>Example of assign agreement request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'assign_agreement'</span><span class="p">,</span>
    <span class="nx">console_id</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">agreement_id</span><span class="p">:</span> <span class="s1">'-KuYrIw65D3'</span><span class="p">,</span>
        <span class="nx">auth_code</span><span class="p">:</span> <span class="s1">'73376d6a-e457-4a66-b06a-c16a637cfa4b'</span><span class="p">,</span>
        <span class="nx">client_id</span><span class="p">:</span> <span class="s1">'-GcnvMbGIABF'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Assigns own agreement to another console using agreement&#39;s auth code.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;assign_agreement&#39;</code></td>
</tr>
<tr>
<td>bundle.agreement_id</td>
<td>YES</td>
<td>agreement ID</td>
</tr>
<tr>
<td>bundle.auth_code</td>
<td>YES</td>
<td>agreement auth code</td>
</tr>
<tr>
<td>bundle.client_id</td>
<td>YES</td>
<td>client ID (i.e. console ID) to assign agreement to</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of response for assigning agreement:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-DK9hO0aiwk'</span><span class="p">,</span>
    <span class="nx">status</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>operation status: if it was successfull - <code>&#39;success&#39;</code>, otherwise  - <code>&#39;failure&#39;</code></td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">agreements</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-KuYrIw65D3'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">auth_codes</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'73376d6a-e457-4a66-b06a-c16a637cfa4b'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nx">client</span><span class="p">:</span> <span class="s1">'-GcnvMbGIABF'</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nx">auth_clients</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'-GcnvMbGIABF'</span><span class="p">:</span> <span class="s1">'73376d6a-e457-4a66-b06a-c16a637cfa4b'</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-GcnvMbGIABF'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">agreements</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'-KuYrIw65D3'</span><span class="p">:</span> <span class="p">{</span>
                <span class="nl">active</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/agreements/[agreement_id]/auth_codes/[code]</code></td>
<td>adds a reference to assigned client</td>
</tr>
<tr>
<td><code>/agreements/[agreement_id]/auth_clients</code></td>
<td>adds a assigned client record</td>
</tr>
<tr>
<td><code>/consoles/[client_id]/agreements/</code></td>
<td>adds assigned agreement reference</td>
</tr>
</tbody></table>
<h2 id='create-link'>Create Link</h2>
<blockquote>
<p>Example of link creation request for user:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_link'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">user_id</span><span class="p">:</span> <span class="s1">'+111222333444'</span><span class="p">,</span>
        <span class="nx">offer</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example of link creation request for campaign:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_link'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">campaign_id</span><span class="p">:</span> <span class="s1">'-Kha84laiFaj'</span><span class="p">,</span>
        <span class="nx">offer</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example of MRGL link creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="s1">'create_link'</span><span class="p">,</span>
    <span class="nx">bundle</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">client_id</span><span class="p">:</span> <span class="s1">'+1234567890'</span><span class="p">,</span>
        <span class="nx">offer</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span><span class="p">,</span>
        <span class="nx">mrgl</span><span class="p">:</span> <span class="p">{</span>
            <span class="nl">recipients_count</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="nx">ttl</span><span class="p">:</span> <span class="mi">20</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>Creates a link for user or campaign.</p>

<p>Server searches for console related to provided user/campaign and tries to find the best agreement with offer&#39;s vendor to make a charge. 
If console&#39;s balance is lower than offer&#39;s price, first of all, console will be topped up.</p>

<p><strong>Request parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>YES</td>
<td><code>&#39;create_link&#39;</code></td>
</tr>
<tr>
<td>bundle.offer</td>
<td>YES</td>
<td>selected offer ID for link</td>
</tr>
<tr>
<td>bundle.user_id</td>
<td>NO</td>
<td>user ID who wants to create a link</td>
</tr>
<tr>
<td>bundle.campaign_id</td>
<td>NO</td>
<td>link must be created for campaign</td>
</tr>
</tbody></table>

<p><strong>MRGL related parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>bundle.mrgl.recipients_count</td>
<td>YES</td>
<td>max recipients count</td>
</tr>
<tr>
<td>bundle.mrgl.ttl</td>
<td>YES</td>
<td>accept timeout in minutes</td>
</tr>
</tbody></table>

<aside class="notice">
Please notice that this request doesn't require a <b>console_id</b> attribute. That's why response is pushed directly to <b>responses path</b>/<b>request's wait_for_response_at</b>.
</aside>

<blockquote>
<p>Example of link creation response:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="nl">request_id</span><span class="p">:</span> <span class="s1">'-JG28Kjale'</span><span class="p">,</span>
    <span class="nx">link</span><span class="p">:</span> <span class="s1">'SyywyKMj-'</span><span class="p">,</span>
    <span class="nx">uri</span><span class="p">:</span> <span class="s1">'http://gifty.link/SyywyKMj-'</span>
<span class="p">}</span>
</code></pre>
<p><strong>Response parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>link</td>
<td>created link ID</td>
</tr>
<tr>
<td>uri</td>
<td>created link URI</td>
</tr>
</tbody></table>

<blockquote>
<p>Example of modified endpoints after processed console&#39;s API key creation request:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">consoles</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'-Bjasf8234l'</span><span class="p">:</span>
        <span class="nl">links</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'SyywyKMj-'</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>
<span class="nx">links</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'SyywyKMj-'</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">agreement</span><span class="p">:</span> <span class="s1">'-Kq2O90gCwo42qeQm16e_public'</span><span class="p">,</span>
        <span class="nx">charge</span><span class="p">:</span> <span class="p">{...},</span>
        <span class="nx">charge_record</span><span class="p">:</span> <span class="s1">'-KudVz0HBL1mSUOwZpMm'</span><span class="p">,</span>
        <span class="nx">console</span><span class="p">:</span> <span class="s1">'-Bjasf8234l'</span><span class="p">,</span>
        <span class="nx">discount</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="nx">kind</span><span class="p">:</span> <span class="s1">'gift'</span><span class="p">,</span>
        <span class="nx">limit</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">offer_id</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span><span class="p">,</span>
        <span class="nx">user</span><span class="p">:</span> <span class="s1">'+111222333444'</span><span class="p">,</span>
        <span class="nx">vendor</span><span class="p">:</span> <span class="s1">'ollia'</span><span class="p">,</span>
        <span class="nx">timestamp</span><span class="p">:</span> <span class="mi">1512506174707</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p><strong>Modified endpoints</strong></p>

<table><thead>
<tr>
<th>Endpoint</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>/consoles/[console_id]/links</code></td>
<td>adds a reference to created link</td>
</tr>
<tr>
<td><code>/links</code></td>
<td>adds a link object with owner and charge details</td>
</tr>
<tr>
<td><code>/transactions</code></td>
<td>adds a charge record</td>
</tr>
<tr>
<td><code>/pay</code></td>
<td>adds a pay cheque</td>
</tr>
</tbody></table>
<h1 id='rest-api-endpoints'>REST API Endpoints</h1><h2 id='verify-key'>Verify Key</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">curl</span> <span class="s2">"http://https://gifty.link/api/verify?key=5a6b5f3f-5845-459c-9c97-89f34ca021e3"</span>
</code></pre>
<blockquote>
<p>Response: </p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="s1">'status'</span><span class="p">:</span> <span class="s1">'success'</span>
<span class="p">}</span>
</code></pre>
<p>URL: <code>/api/verify?key=[api_key]</code></p>

<p>Returns <code>HTTP 200 OK</code> and JSON payload <code>{&quot;status: &quot;success&quot;}</code> if key&#39;s verification is successfull, otherwise - <code>HTTP 400 Bad Request</code>.</p>
<h2 id='get-available-offers'>Get Available Offers</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">curl</span> <span class="s2">"http://gifty.link/api?key=5a6b5f3f-5845-459c-9c97-89f34ca021e3&amp;type=get_offers"</span>
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">[{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'gravity_yyc_cappuccino'</span><span class="p">,</span>
    <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Gravity YYC Cappuccino'</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'gravity_yyc_chardonnay'</span><span class="p">,</span>
    <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Gravity YYC Chardonnay'</span>
<span class="p">},{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'ollia_offer_tea'</span><span class="p">,</span>
    <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Ollia Offer Tea'</span>
<span class="p">},{</span>
    <span class="s1">'id'</span><span class="p">:</span> <span class="s1">'ollia_offer_three'</span><span class="p">,</span>
    <span class="s1">'name'</span><span class="p">:</span> <span class="s1">'Ollia Offer Three'</span>
<span class="p">}]</span>
</code></pre>
<p>URL: <code>/api/?key=[api_key]&amp;type=get_offers</code></p>

<p>Returns <code>HTTP 200 OK</code> and array of available offers IDs and name in JSON format if request is successfull, otherwise - <code>HTTP 400 Bad Request</code>.</p>
<h2 id='link-creation'>Link Creation</h2>
<blockquote>
<p>Example:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="nx">curl</span> <span class="s2">"http://gifty.link/api?key=5a6b5f3f-5845-459c-9c97-89f34ca021e3&amp;type=create_link&amp;offer=gravity_yyc_chardonnay"</span>
</code></pre>
<blockquote>
<p>Response:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
    <span class="s1">'request_id'</span><span class="p">:</span> <span class="s1">'-Kux_EhzastWPiNM8fLy'</span><span class="p">,</span>
    <span class="s1">'link'</span><span class="p">:</span> <span class="s1">'SJmMfjwiZ'</span><span class="p">,</span>
    <span class="s1">'uri'</span><span class="p">:</span> <span class="s1">'https://gifty.link/SJmMfjwiZ'</span>
<span class="p">}</span>
</code></pre>
<p>URL: <code>/api/?key=[api_key]&amp;type=create_link&amp;offer=[offer_id]</code></p>

<p>Returns <code>HTTP 200 OK</code> and created link details in JSON format if request is successfull, otherwise - <code>HTTP 400 Bad Request</code>.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
